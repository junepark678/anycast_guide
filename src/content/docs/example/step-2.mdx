---
title: "Step 2: IRR & RPKI Setup"
description: "Configure Internet Routing Registry entries and RPKI ROAs for your anycast prefixes. Essential for route validation and upstream acceptance."
---

import { Tabs, TabItem, Aside, LinkCard, Steps } from '@astrojs/starlight/components';

With your IP space and ASN acquired, the next critical step is registering your routes in the Internet Routing Registry (IRR) and setting up RPKI for cryptographic route origin validation.

## Why This Matters

Most transit providers and IXPs require:
- **IRR Registration**: For prefix filtering based on route objects
- **RPKI ROAs**: For Route Origin Authorization validation

Without these, your BGP announcements will likely be rejected by upstream providers.

<Aside type="caution">
Skipping this step is the most common reason for failed BGP sessions. Complete IRR and RPKI setup before attempting to announce your prefixes.
</Aside>

## IRR Registration

The IRR is a distributed database of routing policies. You'll need to create objects for your ASN and prefixes.

### Creating IRR Objects

For our example resources (AS65536, 2001:db8:abcd::/48):

<Tabs>
  <TabItem label="aut-num Object">
```
aut-num:        AS65536
as-name:        EXAMPLE-ANYCAST
descr:          Example Anycast Network
org:            ORG-EXAMPLE-RIPE
admin-c:        ADMIN-RIPE
tech-c:         TECH-RIPE
status:         ASSIGNED
mnt-by:         EXAMPLE-MNT
created:        2024-01-15T12:00:00Z
last-modified:  2024-01-15T12:00:00Z
source:         RIPE
```
  </TabItem>
  <TabItem label="route6 Object (IPv6)">
```
route6:         2001:db8:abcd::/48
descr:          Example Anycast IPv6
origin:         AS65536
mnt-by:         EXAMPLE-MNT
created:        2024-01-15T12:00:00Z
last-modified:  2024-01-15T12:00:00Z
source:         RIPE
```
  </TabItem>
</Tabs>

### Submitting IRR Objects

<Steps>
1. **Access your RIR/LIR portal**
   
   Log into your RIR's database portal (e.g., RIPE Database, ARIN IRR)

2. **Create route objects**
   
   Submit route and route6 objects linking your prefixes to your ASN

3. **Verify creation**
   ```bash
   # Check route object
   whois -h whois.radb.net 2001:db8:abcd::/48
   ```

4. **Wait for propagation**
   
   IRR updates typically propagate within minutes to hours
</Steps>

## RPKI Setup

RPKI (Resource Public Key Infrastructure) provides cryptographic verification of route origins through ROAs (Route Origin Authorizations).

### Creating ROAs

<Steps>
1. **Access your RIR's RPKI portal**
   
   Each RIR has an RPKI dashboard:
   - RIPE: https://my.ripe.net
   - ARIN: https://account.arin.net
   - APNIC: https://myapnic.net

2. **Create ROAs for your prefixes**
   
   For each prefix, specify:
   - **Prefix**: The IP range (e.g., 2001:db8:abcd::/48)
   - **Maximum Length**: Usually same as prefix length for anycast
   - **Origin ASN**: Your ASN (AS65536)

3. **Example ROA entries**
   
   | Prefix | Max Length | Origin ASN |
   |--------|------------|------------|
   | 2001:db8:abcd::/48 | /48 | AS65536 |

4. **Publish ROAs**
   
   Submit and publish your ROAs through the portal
</Steps>

<Aside type="tip">
Set the maximum prefix length equal to your announced prefix length. This prevents sub-prefix hijacking while allowing your exact announcements.
</Aside>

### Verifying RPKI

After creating ROAs, verify they're published:

```bash
# Using RIPE's RPKI validator
curl -s "https://rpki-validator.ripe.net/api/v1/validity/AS65536/2001:db8:abcd::/48" | jq

# Using Cloudflare's RPKI toolkit
curl -s "https://rpki.cloudflare.com/api/v1/prefix/2001:db8:abcd::/48" | jq
```

Expected response should show `"state": "valid"` with your ASN as the origin.

## Verification Checklist

Before proceeding, confirm:

- [ ] Route objects exist in IRR for all prefixes
- [ ] ROAs are published for all prefixes
- [ ] RPKI validation shows "valid" status
- [ ] Objects reference the correct origin ASN

```bash
# Full verification script
echo "=== IRR Check ==="
whois -h whois.radb.net 2001:db8:abcd::/48

echo "=== RPKI Check ==="
# Check with your preferred RPKI validator
```

## Common Issues

| Issue | Cause | Solution |
|-------|-------|----------|
| ROA not found | Propagation delay | Wait 15-30 minutes, then recheck |
| Invalid state | Wrong origin ASN | Verify ASN in ROA matches your ASN |
| Route filtered | Missing IRR object | Create route/route6 objects |

## Next Step

With IRR and RPKI configured, you're ready to set up BGP on your servers.

<LinkCard
  title="Step 3: BGP Setup"
  description="Configure BIRD or FRR for BGP announcements."
  href="/example/step-3"
/>

## Related Documentation

<LinkCard
  title="IRR & RPKI Setup Guide"
  description="Comprehensive guide to route registration and RPKI."
  href="/resources/irr-rpki"
/>
